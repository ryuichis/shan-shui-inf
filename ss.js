var Prng=new function(){this.s=1234,this.p=999979,this.q=999983,this.m=this.p*this.q,this.hash=function(n){for(var e=window.btoa(JSON.stringify(n)),d=0,o=0;o<e.length;o++)d+=e.charCodeAt(o)*Math.pow(128,o);return d},this.seed=function(n){function e(){d=(Prng.hash(n)+o)%Prng.m,o+=1}n==null&&(n=new Date().getTime());for(var d=0,o=0;0==d%Prng.p||0==d%Prng.q||0==d||1==d;)e();Prng.s=d;for(var t=0;10>t;t++)Prng.next()},this.next=function(){return Prng.s=Prng.s*Prng.s%Prng.m,Prng.s/Prng.m}};Math.random=function(){return Prng.next()},Math.seed=function(n){return Prng.seed(n)};function parseArgs(n){var d=window.location.href.split("?")[1];if(null!=d){d=d.split("&");for(var o,t=0;t<d.length;t++){o=d[t].split("=");try{n[o[0]](o[1])}catch(n){console.log(n)}}}}SEED=""+new Date().getTime(),parseArgs({seed:function(n){SEED=""==n?SEED:n}}),Math.seed(SEED);var Noise=new function(){var n,e=16,i=8,d=4095,t=4,a=.5,r=function(n){return .5*(1-Math.cos(n*Math.PI))};this.noise=function(l,h,s){if(h=h||0,s=s||0,null==n){n=Array(d+1);for(var u=0;u<d+1;u++)n[u]=Math.random()}0>l&&(l=-l),0>h&&(h=-h),0>s&&(s=-s);for(var f,g,c,m,p,w,b=Math.floor(l),P=Math.floor(h),I=Math.floor(s),v=l-b,k=h-P,j=s-I,F=0,q=.5,T=0;T<t;T++)w=b+(P<<4)+(I<<i),f=r(v),g=r(k),c=n[w&d],c+=f*(n[w+1&d]-c),m=n[w+e&d],m+=f*(n[w+e+1&d]-m),c+=g*(m-c),w+=1<<i,m=n[w&d],m+=f*(n[w+1&d]-m),p=n[w+e&d],p+=f*(n[w+e+1&d]-p),m+=g*(p-m),c+=r(j)*(m-c),F+=c*q,q*=a,b<<=1,v*=2,P<<=1,k*=2,I<<=1,j*=2,1<=v&&(b++,v--),1<=k&&(P++,k--),1<=j&&(I++,j--);return F},this.noiseDetail=function(n,e){0<n&&(t=n),0<e&&(a=e)},this.noiseSeed=function(e){var o=function(){var n,e;return{setSeed:function(i){e=n=(null==i?Math.random()*4294967296:i)>>>0},getSeed:function(){return n},rand:function(){return e=(1664525*e+1013904223)%4294967296,e/4294967296}}}();o.setSeed(e),n=Array(d+1);for(var t=0;t<d+1;t++)n[t]=o.rand()}},PolyTools=new function(){this.midPt=function(){var n=1==arguments.length?arguments[0]:Array.apply(null,arguments);return n.reduce(function(e,i){return[i[0]/n.length+e[0],i[1]/n.length+e[1]]},[0,0])},this.triangulate=function(n,e){function i(n,e){var i=e[0]-n[0],d=0==i?1/0:(e[1]-n[1])/i,o=n[1]-d*n[0];return[d,o]}function d(n,e){function d(n,e){return Math.min(e[0][0],e[1][0])<=n[0]&&n[0]<=Math.max(e[0][0],e[1][0])&&Math.min(e[0][1],e[1][1])<=n[1]&&n[1]<=Math.max(e[0][1],e[1][1])}var o=i(...n),t=i(...e),a=o[0]-t[0];if(0==a)return!1;var r=(t[1]-o[1])/a,l=o[0]*r+o[1];return!!(d([r,l],n)&&d([r,l],e))&&[r,l]}function o(n,e){for(var o=0,t=0;t<e.length;t++){var a=e[t==e.length-1?0:t+1],r=d([e[t],a],[n,[n[0]+999,n[1]+999]]);!1!=r&&o++}return 1==o%2}function t(n,e){var t=[[0,0],[0,0]],a=.01;t[0][0]=n[0][0]*(1-a)+n[1][0]*a,t[0][1]=n[0][1]*(1-a)+n[1][1]*a,t[1][0]=n[0][0]*a+n[1][0]*(1-a),t[1][1]=n[0][1]*a+n[1][1]*(1-a);for(var r=0;r<e.length;r++){var l=e[r],h=e[r==e.length-1?0:r+1];if(!1!=d(t,[l,h]))return!1}var s=PolyTools.midPt(n);return!1!=o(s,e)}function r(n){for(var e=[],d=0;d<n.length;d++){var o=n[d],t=n[d==n.length-1?0:d+1],a=Math.sqrt(Math.pow(t[0]-o[0],2)+Math.pow(t[1]-o[1],2));e.push(a)}return e}function l(n){var e=r(n),i=e[0],d=e[1],o=e[2],t=(i+d+o)/2;return Math.sqrt(t*(t-i)*(t-d)*(t-o))}function h(n){var e=l(n),i=r(n).reduce(function(e,i){return e+i},0);return e/i}function s(n,e){if(0==n.length)return[];if(l(n)<e)return[n];var i=r(n),d=i.reduce((n,e,d,i)=>e>i[n]?d:n,0),o=(d+1)%n.length,t=(d+2)%n.length;try{var a=PolyTools.midPt([n[d],n[o]])}catch(n){return[]}return s([n[d],a,n[t]],e).concat(s([n[t],n[o],a],e))}var e=e==null?{}:e,u=e.area==null?100:e.area,f=e.convex!=null&&e.convex,g=!(e.optimize!=null)||e.optimize;if(3>=n.length)return s(n,u);var c=function(n){for(var e=[],d=0;d<n.length;d++){var o=n[d],a=n[0==d?n.length-1:d-1],l=n[d==n.length-1?0:d+1],s=n.slice();if(s.splice(d,1),f||t([a,l],n)){var u=[[a,o,l],s];if(!g)return u;e.push(u)}}for(var c,m=[n,[]],p=0,d=0;d<e.length;d++)c=h(e[d][0]),c>=p&&(m=e[d],p=c);return m}(n);return s(c[0],u).concat(PolyTools.triangulate(c[1],e))}};function unNan(n){return"object"!=typeof n||null==n?n||0:n.map(unNan)}function distance(n,e){return Math.sqrt(Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2))}function mapval(n,e,i,d,o){return d+(o-d)*(1*(n-e)/(i-e))}function loopNoise(n){for(var e=n[n.length-1]-n[0],d=[100,-100],o=0;o<n.length;o++)n[o]+=e*(n.length-1-o)/(n.length-1),n[o]<d[0]&&(d[0]=n[o]),n[o]>d[1]&&(d[1]=n[o]);for(var o=0;o<n.length;o++)n[o]=mapval(n[o],d[0],d[1],0,1)}function randChoice(n){return n[Math.floor(n.length*Math.random())]}function normRand(n,e){return mapval(Math.random(),0,1,n,e)}function wtrand(n){var e=Math.random(),i=Math.random();return i<n(e)?e:wtrand(n)}function randGaussian(){return 2*wtrand(function(n){return Math.pow(Math.E,-24*Math.pow(n-.5,2))})-1}function bezmh(n,e){e=e==null?1:e,2==n.length&&(n=[n[0],PolyTools.midPt(n[0],n[1]),n[1]]);for(var d=[],o=0;o<n.length-2;o++){var a,r,l;a=0==o?n[o]:PolyTools.midPt(n[o],n[o+1]),r=n[o+1],l=o==n.length-3?n[o+2]:PolyTools.midPt(n[o+1],n[o+2]);for(var h=20,s=0;s<h+(o==n.length-3);s+=1){var f=s/h,t=Math.pow(1-f,2)+2*f*(1-f)*e+f*f;d.push([(Math.pow(1-f,2)*a[0]+2*f*(1-f)*r[0]*e+f*f*l[0])/t,(Math.pow(1-f,2)*a[1]+2*f*(1-f)*r[1]*e+f*f*l[1])/t])}}return d}function poly(n,e){for(var e=null==e?{}:e,d=null==e.xof?0:e.xof,o=null==e.yof?0:e.yof,t=null==e.fil?"rgba(0,0,0,0)":e.fil,a=null==e.str?t:e.str,r=null==e.wid?0:e.wid,l="<polyline points='",h=0;h<n.length;h++)l+=" "+(n[h][0]+d).toFixed(1)+","+(n[h][1]+o).toFixed(1);return l+="' style='fill:"+t+";stroke:"+a+";stroke-width:"+r+"'/>",l}function stroke(n,e){var e=e==null?{}:e,d=e.xof==null?0:e.xof,o=e.yof==null?0:e.yof,t=e.wid==null?2:e.wid,r=e.col==null?"rgba(200,200,200,0.9)":e.col,l=e.noi==null?.5:e.noi,h=e.out==null?1:e.out,s=e.fun==null?function(n){return Math.sin(n*Math.PI)}:e.fun;if(0==n.length)return"";vtxlist0=[],vtxlist1=[],vtxlist=[];for(var u,f=10*Math.random(),g=1;g<n.length-1;g++){u=t*s(g/n.length),u=u*(1-l)+u*l*Noise.noise(.5*g,f);var c=Math.atan2(n[g][1]-n[g-1][1],n[g][0]-n[g-1][0]),m=Math.atan2(n[g][1]-n[g+1][1],n[g][0]-n[g+1][0]),p=(c+m)/2;p<m&&(p+=Math.PI),vtxlist0.push([n[g][0]+u*Math.cos(p),n[g][1]+u*Math.sin(p)]),vtxlist1.push([n[g][0]-u*Math.cos(p),n[g][1]-u*Math.sin(p)])}vtxlist=[n[0]].concat(vtxlist0.concat(vtxlist1.concat([n[n.length-1]]).reverse())).concat([n[0]]);var x=poly(vtxlist.map(function(n){return[n[0]+d,n[1]+o]}),{fil:r,str:r,wid:h});return x}function blob(n,e,d){for(var d=d==null?{}:d,o=d.len==null?20:d.len,t=d.wid==null?5:d.wid,r=d.ang==null?0:d.ang,h=d.col==null?"rgba(200,200,200,0.9)":d.col,s=d.noi==null?.5:d.noi,u=d.ret==null?0:d.ret,f=d.fun==null?function(n){return 1>=n?Math.pow(Math.sin(n*Math.PI),.5):-Math.pow(Math.sin((n+1)*Math.PI),.5)}:d.fun,g=20,c=[],m=0;m<g+1;m++){var w=2*(m/g),p=o/2-Math.abs(w-1)*o,x=f(w)*t/2,b=Math.atan2(x,p),a=Math.sqrt(p*p+x*x);c.push([a,b])}for(var l=[],y=10*Math.random(),m=0;m<g+1;m++)l.push(Noise.noise(.05*m,y));loopNoise(l);for(var P=[],m=0;m<c.length;m++){var I=l[m]*s+(1-s),v=n+Math.cos(c[m][1]+r)*c[m][0]*I,k=e+Math.sin(c[m][1]+r)*c[m][0]*I;P.push([v,k])}return 0==u?poly(P,{fil:h,str:h,wid:0}):P}function div(n,e){for(var d=(n.length-1)*e,o=0,t=0,a=[],r=0;r<d;r+=1){var l=n[Math.floor(r/e)],h=n[Math.ceil(r/e)],s=r%e/e,u=l[0]*(1-s)+h[0]*s,f=l[1]*(1-s)+h[1]*s,g=Math.atan2(f-t,u-o);a.push([u,f]),o=u,t=f}return 0<n.length&&a.push(n[n.length-1]),a}var texture=function(n,e){for(var e=e==null?{}:e,d=e.xof==null?0:e.xof,o=e.yof==null?0:e.yof,t=e.tex==null?400:e.tex,a=e.wid==null?1.5:e.wid,r=e.len==null?.2:e.len,l=e.sha==null?0:e.sha,h=e.ret==null?0:e.ret,s=e.noi==null?function(n){return 30/n}:e.noi,u=e.col==null?function(){return"rgba(100,100,100,"+(.3*Math.random()).toFixed(3)+")"}:e.col,f=e.dis==null?function(){return .5<Math.random()?1/3*Math.random():2/3+1/3*Math.random()}:e.dis,g=[n.length,n[0].length],c=[],m=0;m<t;m++){var w=0|f()*g[1],b=Math.floor(Math.random()*(g[1]*r)),P=w-b,I=w+b;P=Math.min(Math.max(P,0),g[1]),I=Math.min(Math.max(I,0),g[1]);var v=m/t*(g[0]-1);c.push([]);for(var k=P;k<I;k++){var F=v-Math.floor(v),p=n[Math.floor(v)][k][0]*F+n[Math.ceil(v)][k][0]*(1-F),x=n[Math.floor(v)][k][1]*F+n[Math.ceil(v)][k][1]*(1-F),y=[s(v+1)*(Noise.noise(p,.5*k)-.5),s(v+1)*(Noise.noise(x,.5*k)-.5)];c[c.length-1].push([p+y[0],x+y[1]])}}var q="";if(l)for(var k=0;k<c.length;k+=1+(0!=l))q+=stroke(c[k].map(function(n){return[n[0]+d,n[1]+o]}),{col:"rgba(100,100,100,0.1)",wid:l});for(var k=0+l;k<c.length;k+=1+l)q+=stroke(c[k].map(function(n){return[n[0]+d,n[1]+o]}),{col:u(k/c.length),wid:a});return h?c:q},Tree=new function(){this.tree01=function(n,e,d){var d=null==d?{}:d,o=null==d.hei?50:d.hei,t=null==d.wid?3:d.wid,a=null==d.col?"rgba(100,100,100,0.5)":d.col,r=null==d.noi?.5:d.noi;reso=10;for(var l=[],h=0;h<reso;h++)l.push([Noise.noise(.5*h),Noise.noise(.5*h,.5)]);var s=a.includes("rgba(")?a.replace("rgba(","").replace(")","").split(","):["100","100","100","0.5"];for(var u="",f=[],g=[],h=0;h<reso;h++){var c=n,m=e-h*o/reso;if(h>=reso/4)for(var p=0;p<(reso-h)/5;p++)u+=blob(c+1.2*((Math.random()-.5)*t)*(reso-h),m+(Math.random()-.5)*t,{len:.2*(20*Math.random()*(reso-h))+10,wid:6*Math.random()+3,ang:(Math.random()-.5)*Math.PI/6,col:"rgba("+s[0]+","+s[1]+","+s[2]+","+(.2*Math.random()+parseFloat(s[3])).toFixed(1)+")"});f.push([c+(l[h][0]-.5)*t-t/2,m]),g.push([c+(l[h][1]-.5)*t+t/2,m])}return u+=poly(f,{fil:"none",str:a,wid:1.5})+poly(g,{fil:"none",str:a,wid:1.5}),u},this.tree02=function(n,e,d){var d=d==null?{}:d,o=d.hei==null?16:d.hei,t=d.wid==null?8:d.wid,a=d.clu==null?5:d.clu,r=d.col==null?"rgba(100,100,100,0.5)":d.col,l=d.noi==null?.5:d.noi;r.includes("rgba(")?r.replace("rgba(","").replace(")","").split(","):["100","100","100","0.5"];for(var h="",s=0;s<a;s++)h+=blob(n+4*(randGaussian()*a),e+4*(randGaussian()*a),{ang:Math.PI/2,col:"rgba(100,100,100,0.8)",fun:function(n){return 1>=n?Math.pow(Math.sin(n*Math.PI)*n,.5):-Math.pow(Math.sin((n-2)*Math.PI*(n-2)),.5)},wid:.75*(Math.random()*t)+.5*t,len:.75*(Math.random()*o)+.5*o,col:r});return h},this.tree03=function(n,e,d){var d=null==d?{}:d,o=null==d.hei?50:d.hei,t=null==d.wid?5:d.wid,a=null==d.ben?function(){return 0}:d.ben,r=null==d.col?"rgba(100,100,100,0.5)":d.col,l=null==d.noi?.5:d.noi;reso=10;for(var h=[],s=0;s<reso;s++)h.push([Noise.noise(.5*s),Noise.noise(.5*s,.5)]);var u=r.includes("rgba(")?r.replace("rgba(","").replace(")","").split(","):["100","100","100","0.5"];for(var f="",g="",c=[],m=[],s=0;s<reso;s++){var p=n+100*a(s/reso),w=e-s*o/reso;if(s>=reso/5)for(var x=0;x<2*(reso-s);x++){var b=function(n){return Math.log(50*n+1)/3.95},y=2*(Math.random()*t)*b((reso-s)/reso);g+=blob(p+y*randChoice([-1,1]),w+2*((Math.random()-.5)*t),{len:2*y,wid:6*Math.random()+3,ang:(Math.random()-.5)*Math.PI/6,col:"rgba("+u[0]+","+u[1]+","+u[2]+","+(.2*Math.random()+parseFloat(u[3])).toFixed(3)+")"})}c.push([p+((h[s][0]-.5)*t-t/2)*(reso-s)/reso,w]),m.push([p+((h[s][1]-.5)*t+t/2)*(reso-s)/reso,w])}var P=c.concat(m.reverse());return f+=poly(P,{fil:"white",str:r,wid:1.5}),f+=g,f};var n=function(n){var e,n=n==null?{}:n,o=n.hei==null?300:n.hei,t=n.wid==null?6:n.wid,r=n.ang==null?0:n.ang,l=n.det==null?10:n.det,h=n.ben==null?.2*Math.PI:n.ben,s=0,u=0;e=[[s,u]];for(var f=0,c=3,g=0;g<c;g++)f+=(h/2+Math.random()*h/2)*randChoice([-1,1]),s+=Math.cos(f)*o/c,u-=Math.sin(f)*o/c,e.push([s,u]);for(var m=Math.atan2(e[e.length-1][1],e[e.length-1][0]),g=0;g<e.length;g++){var w=Math.atan2(e[g][1],e[g][0]),a=Math.sqrt(e[g][0]*e[g][0]+e[g][1]*e[g][1]);e[g][0]=a*Math.cos(w-m+r),e[g][1]=a*Math.sin(w-m+r)}for(var d=[],x=[],y=l,P=(e.length-1)*y,I=0,v=0,g=0;g<P;g+=1){var k=e[Math.floor(g/y)],j=e[Math.ceil(g/y)],F=g%y/y,s=k[0]*(1-F)+j[0]*F,u=k[1]*(1-F)+j[1]*F,r=Math.atan2(u-v,s-I),p=(Noise.noise(.3*g)-.5)*t*o/80,q=0;0==F&&(q=Math.random()*t);var z=t*(.5*((P-g)/P)+.5);d.push([s+Math.cos(r+Math.PI/2)*(z+p+q),u+Math.sin(r+Math.PI/2)*(z+p+q)]),x.push([s+Math.cos(r-Math.PI/2)*(z-p+q),u+Math.sin(r-Math.PI/2)*(z-p+q)]),I=s,v=u}return[d,x]},e=function(n,o,t,r){for(var r=null==r?{}:r,l=null==r.dir?1:r.dir,h=null==r.sca?1:r.sca,s=null==r.wid?1:r.wid,u=null==r.ang?0:r.ang,f=null==r.lea?[!0,12]:r.lea,g="",c=[],m=10,p=.5*Math.random()+.5,w=function(){return-1/Math.pow(y/m+1,5)+1},x=randChoice([w]),b=Math.random()*Math.PI/6*l+u,y=0;y<m;y++){var P=50*(l*x(y/m))*h*p,I=5*-y*h,v=Math.atan2(I,P),a=Math.pow(P*P+I*I,.5),d=Math.cos(v+b)*a,k=Math.sin(v+b)*a;if(c.push([d+n,k+o]),(y==(0|m/3)||y==(0|2*m/3))&&0<t&&(g+=e(d+n,k+o,t-1,{ang:u,sca:.8*h,wid:s,dir:l*randChoice([-1,1]),lea:f})),y==m-1&&!0==f[0])for(var F,q=0;5>q;q++)F=5*(q-2.5),g+=blob(d+n+Math.cos(u)*F*s,k+o+(Math.sin(u)*F-f[1]/(t+1))*s,{wid:(6+3*Math.random())*s,len:(15+12*Math.random())*s,ang:u/2+Math.PI/2+.2*Math.PI*(Math.random()-.5),col:"rgba(100,100,100,"+(.5+.2*t).toFixed(3)+")",fun:function(n){return 1>=n?Math.pow(Math.sin(n*Math.PI)*n,.5):-Math.pow(Math.sin((n-2)*Math.PI*(n-2)),.5)}})}return g+=stroke(c,{wid:1,fun:function(n){return Math.cos(n*Math.PI/2)},col:"rgba(100,100,100,0.5)"}),g},d=function(n,e,d){function o(n,e,d,o){for(var t=10+10*Math.random(),r=.5,h=function(n){return 1>=n?Math.pow(Math.sin(n*Math.PI),.5):-Math.pow(Math.sin((n+1)*Math.PI),.5)},s=20,u="",f=[],g=0;g<s+1;g++){var c=2*(g/s),m=t/2-Math.abs(c-1)*t,p=h(c)*d/2,w=Math.atan2(p,m),a=Math.sqrt(m*m+p*p);f.push([a,w])}for(var l=[],x=10*Math.random(),g=0;g<s+1;g++)l.push(Noise.noise(.05*g,x));loopNoise(l);for(var b=[],g=0;g<f.length;g++){var y=l[g]*r+(1-r),P=n+Math.cos(f[g][1]+o)*f[g][0]*y,I=e+Math.sin(f[g][1]+o)*f[g][0]*y;b.push([P,I])}var v=Math.random();return u+=stroke(b,{wid:.8,noi:0,col:"rgba(100,100,100,0.4)",out:0,fun:function(n){return Math.sin(3*((n+v)*Math.PI))}}),u}for(var t="",a=2;a<d[0].length-1;a++){var r=Math.atan2(d[0][a][1]-d[0][a-1][1],d[0][a][0]-d[0][a-1][0]),l=Math.atan2(d[1][a][1]-d[1][a-1][1],d[1][a][0]-d[1][a-1][0]),h=Math.random(),s=d[0][a][0]*(1-h)+d[1][a][0]*h,u=d[0][a][1]*(1-h)+d[1][a][1]*h;if(t+=.2>Math.random()?blob(s+n,u+e,{noi:1,len:15,wid:6-10*Math.abs(h-.5),ang:(r+l)/2,col:"rgba(100,100,100,0.6)"}):o(s+n,u+e,5-10*Math.abs(h-.5),(r+l)/2),.05>Math.random())for(var f=2*Math.random()+2,g=randChoice([[d[0][a][0],d[0][a][1],r],[d[1][a][0],d[1][a][1],l]]),c=0;c<f;c++)t+=blob(g[0]+n+4*(Math.cos(g[2])*(c-f/2)),g[1]+e+4*(Math.sin(g[2])*(c-f/2)),{wid:4,len:4+6*Math.random(),ang:r+Math.PI/2,col:"rgba(100,100,100,0.6)"})}for(var m=d[0].concat(d[1].slice().reverse()),p=[[]],a=0;a<m.length;a++).5>Math.random()?p.push([]):p[p.length-1].push(m[a]);for(var a=0;a<p.length;a++){p[a]=div(p[a],4);for(var c=0;c<p[a].length;c++)p[a][c][0]+=(Noise.noise(a,.1*c,1)-.5)*(15+5*randGaussian()),p[a][c][1]+=(Noise.noise(a,.1*c,2)-.5)*(15+5*randGaussian());t+=stroke(p[a].map(function(i){return[i[0]+n,i[1]+e]}),{wid:1.5,col:"rgba(100,100,100,0.7)",out:0})}return t};this.tree04=function(o,t,a){var a=null==a?{}:a,r=null==a.hei?300:a.hei,l=null==a.wid?6:a.wid,h=null==a.col?"rgba(100,100,100,0.5)":a.col,s=null==a.noi?.5:a.noi,u="",f="",g="",c=n({hei:r,wid:l,ang:-Math.PI/2});f+=d(o,t,c),c=c[0].concat(c[1].reverse());for(var m=[],p=0;p<c.length;p++)if(p>=.3*c.length&&p<=.7*c.length&&.1>Math.random()||p==c.length/2-1){var w=.2*Math.PI-1.4*Math.PI*(p>c.length/2),x=n({hei:.3*(r*(Math.random()+1)),wid:.5*l,ang:w});x[0].splice(0,1),x[1].splice(0,1);var b=function(n){return[n[0]+c[p][0],n[1]+c[p][1]]};f+=d(o,t,[x[0].map(b),x[1].map(b)]);for(var y=0;y<x[0].length;y++)(.2>Math.random()||y==x[0].length-1)&&(g+=e(x[0][y][0]+c[p][0]+o,x[0][y][1]+c[p][1]+t,1,{wid:r/300,ang:w>-Math.PI/2?w:w+Math.PI,sca:.5*r/300,dir:w>-Math.PI/2?1:-1}));x=x[0].concat(x[1].reverse()),m=m.concat(x.map(function(n){return[n[0]+c[p][0],n[1]+c[p][1]]}))}else m.push(c[p]);return u+=poly(m,{xof:o,yof:t,fil:"white",str:h,wid:0}),m.splice(0,1),m.splice(m.length-1,1),u+=stroke(m.map(function(n){return[n[0]+o,n[1]+t]}),{col:"rgba(100,100,100,"+(.4+.1*Math.random()).toFixed(3)+")",wid:2.5,fun:function(){return Math.sin(1)},noi:.9,out:0}),u+=f,u+=g,u},this.tree05=function(o,t,a){var a=null==a?{}:a,r=null==a.hei?300:a.hei,l=null==a.wid?5:a.wid,h=null==a.col?"rgba(100,100,100,0.5)":a.col,s=null==a.noi?.5:a.noi,u="",f="",g="",c=n({hei:r,wid:l,ang:-Math.PI/2,ben:0});f+=d(o,t,c),c=c[0].concat(c[1].reverse());for(var m,w=[],x=0;x<c.length;x++)if(m=Math.abs(x-.5*c.length)/(.5*c.length),x>=.2*c.length&&x<=.8*c.length&&0==x%3&&Math.random()>m||x==c.length/2-1){var b=.2*Math.random(),y=-b*Math.PI-(1-2*b)*Math.PI*(x>c.length/2),P=n({hei:r*(.3*m-.05*Math.random()),wid:.5*l,ang:y,ben:.5});P[0].splice(0,1),P[1].splice(0,1);for(var I=0;I<P[0].length;I++)(0==I%20||I==P[0].length-1)&&(g+=e(P[0][I][0]+c[x][0]+o,P[0][I][1]+c[x][1]+t,0,{wid:r/300,ang:y>-Math.PI/2?y:y+Math.PI,sca:.2*r/300,dir:y>-Math.PI/2?1:-1,lea:[!0,5]}));P=P[0].concat(P[1].reverse()),w=w.concat(P.map(function(n){return[n[0]+c[x][0],n[1]+c[x][1]]}))}else w.push(c[x]);return u+=poly(w,{xof:o,yof:t,fil:"white",str:h,wid:0}),w.splice(0,1),w.splice(w.length-1,1),u+=stroke(w.map(function(n){return[n[0]+o,n[1]+t]}),{col:"rgba(100,100,100,"+(.4+.1*Math.random()).toFixed(3)+")",wid:2.5,fun:function(){return Math.sin(1)},noi:.9,out:0}),u+=f,u+=g,u},this.tree06=function(i,o,t){function a(o,t,r,l){var l=null==l?{}:l,h=null==l.hei?300:l.hei,s=null==l.wid?5:l.wid,u=null==l.ang?0:l.ang,c=null==l.ben?.2*Math.PI:l.ben,m=n({hei:h,wid:s,ang:u,ben:c,det:h/20});f+=d(o,t,m),m=m[0].concat(m[1].reverse());for(var w,x=[],b=0;b<m.length;b++)if(w=Math.abs(b-.5*m.length)/(.5*m.length),(.025>Math.random()&&b>=.2*m.length&&b<=.8*m.length||b==(0|m.length/2)-1||b==(0|m.length/2)+1)&&0<r){for(var y=.02+.08*Math.random(),P=y*Math.PI-2*y*Math.PI*(b>m.length/2),I=a(m[b][0]+o,m[b][1]+t,r-1,{hei:h*(.7+.2*Math.random()),wid:.6*s,ang:u+P,ben:.55}),v=0;v<I.length;v++).03>Math.random()&&(g+=e(I[v][0]+m[b][0]+o,I[v][1]+m[b][1]+t,2,{ang:P*(.5*Math.random()+.75),sca:.3,dir:0<P?1:-1,lea:[!1,0]}));x=x.concat(I.map(function(n){return[n[0]+m[b][0],n[1]+m[b][1]]}))}else x.push(m[b]);return x}var t=null==t?{}:t,r=null==t.hei?100:t.hei,l=null==t.wid?6:t.wid,h=null==t.col?"rgba(100,100,100,0.5)":t.col,s=null==t.noi?.5:t.noi,u="",f="",g="",c=a(i,o,3,{hei:r,wid:l,ang:-Math.PI/2,ben:0});return u+=poly(c,{xof:i,yof:o,fil:"white",str:h,wid:0}),c.splice(0,1),c.splice(c.length-1,1),u+=stroke(c.map(function(n){return[n[0]+i,n[1]+o]}),{col:"rgba(100,100,100,"+(.4+.1*Math.random()).toFixed(3)+")",wid:2.5,fun:function(){return Math.sin(1)},noi:.9,out:0}),u+=f,u+=g,u},this.tree07=function(n,e,d){var d=d==null?{}:d,o=d.hei==null?60:d.hei,t=d.wid==null?4:d.wid,a=d.ben==null?function(n){return .2*Math.sqrt(n)}:d.ben,r=d.col==null?"rgba(100,100,100,1)":d.col,l=d.noi==null?.5:d.noi;reso=10;for(var h=[],s=0;s<reso;s++)h.push([Noise.noise(.5*s),Noise.noise(.5*s,.5)]);var u=r.includes("rgba(")?r.replace("rgba(","").replace(")","").split(","):["100","100","100","1"];for(var f="",g=[],p=[],w=[],s=0;s<reso;s++){var x=n+100*a(s/reso),b=e-s*o/reso;if(s>=reso/4)for(var y,P=0;1>P;P++)y=blob(x+.5*(1.2*((Math.random()-.5)*t)*(reso-s)),b+.5*((Math.random()-.5)*t),{len:50*Math.random()+20,wid:12*Math.random()+12,ang:-Math.random()*Math.PI/6,col:"rgba("+u[0]+","+u[1]+","+u[2]+","+parseFloat(u[3]).toFixed(3)+")",fun:function(n){return 1>=n?2.75*n*Math.pow(1-n,1/1.8):2.75*(n-2)*Math.pow(n-1,1/1.8)},ret:1}),w=w.concat(PolyTools.triangulate(y,{area:50,convex:!0,optimize:!1}));g.push([x+(h[s][0]-.5)*t-t/2,b]),p.push([x+(h[s][1]-.5)*t+t/2,b])}w=PolyTools.triangulate(g.concat(p.reverse()),{area:50,convex:!0,optimize:!0}).concat(w);for(var I=0;I<w.length;I++){var v=PolyTools.midPt(w[I]),m=0|200*Noise.noise(.02*v[0],.02*v[1])+50,c="rgba("+m+","+m+","+m+",0.8)";f+=poly(w[I],{fil:c,str:c,wid:0})}return f},this.tree08=function(e,d,o){function t(n,e,o,r){var r=null==r?{}:r,l=null==r.ang?-Math.PI/2:r.ang,h=null==r.len?15:r.len,s=null==r.ben?0:r.ben,u=0==o?function(n){return Math.cos(.5*Math.PI*n)}:function(){return 1},f=[n,e],g=[n+Math.cos(l)*h,e+Math.sin(l)*h],c=[[n,e],[n+h,e]],m=randChoice([function(n){return Math.sin(n*Math.PI)},function(n){return-Math.sin(n*Math.PI)}]);c=div(c,10);for(var p=0;p<c.length;p++)c[p][1]+=2*m(p/c.length);for(var p=0;p<c.length;p++){var w=distance(c[p],f),d=Math.atan2(c[p][1]-f[1],c[p][0]-f[0]);c[p][0]=f[0]+w*Math.cos(d+l),c[p][1]=f[1]+w*Math.sin(d+l)}var a="";if(a+=stroke(c,{fun:u,wid:.8,col:"rgba(100,100,100,0.5)"}),0!=o){var x=s+.001*(randChoice([-1,1])*Math.PI)*o*o;.5>Math.random()?(a+=t(g[0],g[1],o-1,{ang:l+s+.2*(Math.PI*randChoice([normRand(-1,.5),normRand(.5,1)])),len:h*normRand(.8,.9),ben:x}),a+=t(g[0],g[1],o-1,{ang:l+s+.2*(Math.PI*randChoice([normRand(-1,-.5),normRand(.5,1)])),len:h*normRand(.8,.9),ben:x})):a+=t(g[0],g[1],o-1,{ang:l+s,len:h*normRand(.8,.9),ben:x})}return a}var o=null==o?{}:o,a=null==o.hei?80:o.hei,r=null==o.wid?1:o.wid,l=null==o.col?"rgba(100,100,100,0.5)":o.col,h=null==o.noi?.5:o.noi,s="",u="",f=.2*(normRand(-1,1)*Math.PI),g=n({hei:a,wid:r,ang:-Math.PI/2+f,ben:.2*Math.PI,det:a/20});g=g[0].concat(g[1].reverse());for(var c=0;c<g.length;c++).2>Math.random()?u+=t(e+g[c][0],d+g[c][1],Math.floor(4*Math.random()),{hei:20,ang:-Math.PI/2-f*Math.random()}):c==Math.floor(g.length/2)&&(u+=t(e+g[c][0],d+g[c][1],3,{hei:25,ang:-Math.PI/2+f}));return s+=poly(g,{xof:e,yof:d,fil:"white",str:l,wid:0}),s+=stroke(g.map(function(n){return[n[0]+e,n[1]+d]}),{col:"rgba(100,100,100,"+(.6+.1*Math.random()).toFixed(3)+")",wid:2.5,fun:function(){return Math.sin(1)},noi:.9,out:0}),s+="",s+=u,s}},Mount=new function(){var n=function(n,e){for(var e=e==null?{}:e,d=e.xof==null?0:e.xof,o=e.yof==null?0:e.yof,t=e.ret==null?0:e.ret,a=[],r=10,l=0,h=0;h<n.length-2;h+=1)if(h==l){l=Math.min(l+randChoice([1,2]),n.length-1),a.push([]),a.push([]);for(var s=0;s<Math.min(n[h].length/8,10);s++)a[a.length-2].push([n[h][s][0]+10*Noise.noise(.1*s,h),n[h][s][1]]),a[a.length-1].push([n[h][n[h].length-1-s][0]-10*Noise.noise(.1*s,h),n[h][n[h].length-1-s][1]]);a[a.length-2]=a[a.length-2].reverse(),a[a.length-1]=a[a.length-1].reverse();for(var s=0;s<r;s++){var u=s/r,f=n[h][0][0]*(1-u)+n[l][0][0]*u,g=n[h][0][1]*(1-u)+n[l][0][1]*u,c=n[h][n[h].length-1][0]*(1-u)+n[l][n[h].length-1][0]*u,m=n[h][n[h].length-1][1]*(1-u)+n[l][n[h].length-1][1]*u,p=-1.7*(u-1)*Math.pow(u,1/5);g+=5*p+5*Noise.noise(.05*d,h),m+=5*p+5*Noise.noise(.05*d,h),a[a.length-2].push([f,g]),a[a.length-1].push([c,m])}}for(var w="",h=0;h<a.length;h++)w+=poly(a[h],{xof:d,yof:o,fil:"white",str:"none"});for(var s=0;s<a.length;s++)w+=stroke(a[s].map(function(n){return[n[0]+d,n[1]+o]}),{col:"rgba(100,100,100,"+(.1+.1*Math.random()).toFixed(3)+")",wid:1});return t?a:w};this.mountain=function(e,d,o,t){function a(n,e,d){for(var o=[],t=0;t<m.length;t+=1)for(var a=0;a<m[t].length;a+=1)e(t,a)&&o.push([m[t][a][0],m[t][a][1]]);for(var t=0;t<o.length;t++)d(o,t)&&(c+=n(o[t][0],o[t][1]))}var t=null==t?{}:t,r=null==t.hei?100+400*Math.random():t.hei,l=null==t.wid?400+200*Math.random():t.wid,s=null==t.tex?200:t.tex,u=null==t.veg||t.veg,f=null==t.ret?0:t.ret,g=null==t.col?void 0:t.col;o=null==o?0:o;for(var c="",m=[],w=r,h=[10,50],b=0,P=0;P<h[0];P++){b+=Math.random()*d/100,m.push([]);for(var I=0;I<h[1];I++){var v=(I/h[1]-.5)*Math.PI,x=Math.cos(v);x*=Noise.noise(v+10,.15*P,o);var k=1-P/h[0];m[m.length-1].push([v/Math.PI*l*k,-x*w*k+b])}}return a(function(n,i){return Tree.tree02(n+e,i+d-5,{col:"rgba(100,100,100,"+(.3*(.5*Noise.noise(.01*n,.01*i))+.5).toFixed(3)+")",clu:2})},function(n,e){var i=Noise.noise(.1*e,o);return 0==n&&.1>i*i*i&&.2<Math.abs(m[n][e][1])/w},function(){return!0}),c+=poly(m[0].concat([[0,4*h[0]]]),{xof:e,yof:d,fil:"white",str:"none"}),c+=stroke(m[0].map(function(n){return[n[0]+e,n[1]+d]}),{col:"rgba(100,100,100,0.3)",noi:1,wid:3}),c+=n(m,{xof:e,yof:d}),c+=texture(m,{xof:e,yof:d,tex:s,sha:randChoice([0,0,0,0,5]),col:g}),a(function(n,i){return Tree.tree02(n+e,i+d,{col:"rgba(100,100,100,"+(.3*(.5*Noise.noise(.01*n,.01*i))+.5).toFixed(3)+")"})},function(n,e){var i=Noise.noise(.1*n,.1*e,o+2);return .1>i*i*i&&.5<Math.abs(m[n][e][1])/w},function(){return!0}),u&&(a(function(n,i){var o=70*((w+i)/w);return o=.3*o+.7*(Math.random()*o),Tree.tree01(n+e,i+d,{hei:o,wid:3*Math.random()+1,col:"rgba(100,100,100,"+(.3*(.5*Noise.noise(.01*n,.01*i))+.3).toFixed(3)+")"})},function(n,e){var i=Noise.noise(.2*n,.05*e,o);return e%2&&.012>i*i*i*i&&.3>Math.abs(m[n][e][1])/w},function(n,e){for(var i=0,d=0;d<n.length;d++)if(e!=d&&900>Math.pow(n[e][0]-n[d][0],2)+Math.pow(n[e][1]-n[d][1],2)&&i++,2<i)return!0;return!1}),a(function(n,i){var o=120*((w+i)/w);o=.5*o+.5*(Math.random()*o);var t=.1*Math.random();return Tree.tree03(n+e,i+d,{hei:o,ben:function(n){return Math.pow(n*t,1)},col:"rgba(100,100,100,"+(.3*(.5*Noise.noise(.01*n,.01*i))+.3).toFixed(3)+")"})},function(n,e){var i=Noise.noise(.2*n,.05*e,o);return(0==e||e==m[n].length-1)&&.012>i*i*i*i},function(){return!0})),a(function(n,i){var t=randChoice([0,0,1,1,1,2]);return 1==t?Arch.arch02(n+e,i+d,o,{wid:normRand(40,70),sto:randChoice([1,2,2,3]),rot:Math.random(),sty:randChoice([1,2,3])}):2==t?Arch.arch04(n+e,i+d,o,{sto:randChoice([1,1,1,2,2])}):""},function(n,e){var i=Noise.noise(.2*n,.05*e,o+10);return 0!=n&&(1==e||e==m[n].length-2)&&.008>i*i*i*i},function(){return!0}),a(function(n,i){return Arch.arch03(n+e,i+d,o,{sto:randChoice([5,7]),wid:40+20*Math.random()})},function(n,e){return 1==n&&1>Math.abs(e-m[n].length/2)&&.02>Math.random()},function(){return!0}),a(function(n,i){return Arch.transmissionTower01(n+e,i+d,o)},function(n,e){var i=Noise.noise(.2*n,.05*e,o+20*Math.PI);return 0==n%2&&(1==e||e==m[n].length-2)&&.002>i*i*i*i},function(){return!0}),a(function(n,i){return Mount.rock(n+e,i+d,o,{wid:20+20*Math.random(),hei:20+20*Math.random(),sha:2})},function(n,e){return(0==e||e==m[n].length-1)&&.1>Math.random()},function(){return!0}),0==f?c:[m]},this.flatMount=function(n,e,d,o){var o=null==o?{}:o,t=null==o.hei?40+400*Math.random():o.hei,a=null==o.wid?400+200*Math.random():o.wid,r=null==o.tex?80:o.tex,l=null==o.cho?.5:o.cho,s=null==o.ret?0:o.ret;d=null==d?0:d;for(var u="",f=[],g=[5,50],c=0,m=[],w=0;w<g[0];w++){c+=Math.random()*e/100,f.push([]),m.push([]);for(var b=0;b<g[1];b++){var P=(b/g[1]-.5)*Math.PI,x=Math.cos(2*P)+1;x*=Noise.noise(P+10,.1*w,d);var I=1-.6*(w/g[0]),k=P/Math.PI*a*I,F=-x*t*I+c,q=100;F<-q*l+c?(F=-q*l+c,0==m[m.length-1].length%2&&m[m.length-1].push([k,F])):1==m[m.length-1].length%2&&m[m.length-1].push(f[f.length-1][f[f.length-1].length-1]),f[f.length-1].push([k,F])}}u+=poly(f[0].concat([[0,4*g[0]]]),{xof:n,yof:e,fil:"white",str:"none"}),u+=stroke(f[0].map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,0.3)",noi:1,wid:3}),u+=texture(f,{xof:n,yof:e,tex:r,wid:2,dis:function(){return .5<Math.random()?.1+.4*Math.random():.9-.4*Math.random()}});for(var h=[],z=[],b=0;b<m.length;b+=2)2<=m[b].length&&(h.push(m[b][0]),z.push(m[b][m[b].length-1]));if(0==h.length)return u;for(var I,T=[h[0][0],z[0][0]],b=0;3>b;b++)I=.8-.2*b,h.unshift([T[0]*I,h[0][1]-5]),z.unshift([T[1]*I,z[0][1]-5]);T=[h[h.length-1][0],z[z.length-1][0]];for(var I,b=0;3>b;b++)I=.6-.1*(b*b),h.push([T[0]*I,h[h.length-1][1]+1]),z.push([T[1]*I,z[z.length-1][1]+1]);h=div(h,5),z=div(z,5);for(var M,B=h.reverse().concat(z.concat([h[0]])),b=0;b<B.length;b++)M=.12*(1-Math.abs(b%5-5/2)/(5/2)),B[b][0]*=1-M+Noise.noise(.5*B[b][1])*M;u+=poly(B,{xof:n,yof:e,str:"none",fil:"white",wid:2}),u+=stroke(B.map(i=>[i[0]+n,i[1]+e]),{wid:3,col:"rgba(100,100,100,0.2)"});var S=function(n){for(var e,d,o,t,a=0;a<n.length;a++)(null==e||n[a][0]<e)&&(e=n[a][0]),(null==d||n[a][0]>d)&&(d=n[a][0]),(null==o||n[a][1]<o)&&(o=n[a][1]),(null==t||n[a][1]>t)&&(t=n[a][1]);return{xmin:e,xmax:d,ymin:o,ymax:t}};return u+=this.flatDec(n,e,S(B)),u},this.flatDec=function(n,e,d){for(var o="",t=randChoice([0,0,1,2,3,4]),a=0;a<5*Math.random();a++)o+=Mount.rock(n+normRand(d.xmin,d.xmax),e+(d.ymin+d.ymax)/2+normRand(-10,10)+10,100*Math.random(),{wid:10+20*Math.random(),hei:10+20*Math.random(),sha:2});for(var a=0;a<randChoice([0,0,1,2]);a++)for(var r=n+normRand(d.xmin,d.xmax),l=e+(d.ymin+d.ymax)/2+normRand(-5,5)+20,h=0;h<2+3*Math.random();h++)o+=Tree.tree08(r+Math.min(Math.max(normRand(-30,30),d.xmin),d.xmax),l,{hei:60+40*Math.random()});if(0==t)for(var a=0;a<3*Math.random();a++)o+=Mount.rock(n+normRand(d.xmin,d.xmax),e+(d.ymin+d.ymax)/2+normRand(-5,5)+20,100*Math.random(),{wid:50+20*Math.random(),hei:40+20*Math.random(),sha:5});if(1==t){for(var s=.5*Math.random(),u=.5*Math.random()+.5,f=d.xmin*(1-s)+d.xmax*s,g=d.xmin*(1-u)+d.xmax*u,c=f;c<g;c+=30)o+=Tree.tree05(n+c+20*normRand(-1,1),e+(d.ymin+d.ymax)/2+20,{hei:100+200*Math.random()});for(var a=0;a<4*Math.random();a++)o+=Mount.rock(n+normRand(d.xmin,d.xmax),e+(d.ymin+d.ymax)/2+normRand(-5,5)+20,100*Math.random(),{wid:50+20*Math.random(),hei:40+20*Math.random(),sha:5})}else if(2==t)for(var c=0;c<randChoice([1,1,1,1,2,2,3]);c++){var r=normRand(d.xmin,d.xmax),l=(d.ymin+d.ymax)/2;o+=Tree.tree04(n+r,e+l+20,{});for(var a=0;a<2*Math.random();a++)o+=Mount.rock(n+Math.max(d.xmin,Math.min(d.xmax,r+normRand(-50,50))),e+l+normRand(-5,5)+20,100*(a*c*Math.random()),{wid:50+20*Math.random(),hei:40+20*Math.random(),sha:5})}else if(3==t)for(var c=0;c<randChoice([1,1,1,1,2,2,3]);c++)o+=Tree.tree06(n+normRand(d.xmin,d.xmax),e+(d.ymin+d.ymax)/2,{hei:60+60*Math.random()});else if(4==t)for(var s=.5*Math.random(),u=.5*Math.random()+.5,f=d.xmin*(1-s)+d.xmax*s,g=d.xmin*(1-u)+d.xmax*u,c=f;c<g;c+=20)o+=Tree.tree07(n+c+20*normRand(-1,1),e+(d.ymin+d.ymax)/2+normRand(-1,1)+0,{hei:normRand(40,80)});for(var c=0;c<50*Math.random();c++)o+=Tree.tree02(n+normRand(d.xmin,d.xmax),e+normRand(d.ymin,d.ymax));var m=randChoice([0,0,0,0,1]);return 1==m&&4!=t&&(o+=Arch.arch01(n+normRand(d.xmin,d.xmax),e+(d.ymin+d.ymax)/2+20,Math.random(),{wid:normRand(160,200),hei:normRand(80,100),per:Math.random()})),o},this.distMount=function(n,e,d,o){var o=o==null?{}:o,t=o.hei==null?300:o.hei,a=o.len==null?2e3:o.len,r=o.seg==null?5:o.seg;d=d==null?0:d;for(var l="",h=10,s=[],u=0;u<a/h/r;u++){s.push([]);for(var f,g=0;g<r+1;g++)f=function(i){return[n+i*h,e-t*Noise.noise(.05*i,d)*Math.pow(Math.sin(Math.PI*i/(a/h)),.5)]},s[s.length-1].push(f(u*r+g));for(var f,g=0;g<r/2+1;g++)f=function(i){return[n+i*h,e+24*Noise.noise(.05*i,2,d)*Math.pow(Math.sin(Math.PI*i/(a/h)),1)]},s[s.length-1].unshift(f(u*r+2*g))}for(var c,u=0;u<s.length;u++){c=function(n,i){var d=0|55*Noise.noise(.02*n,.02*i,e)+200;return"rgb("+d+","+d+","+d+")"},l+=poly(s[u],{fil:c(...s[u][s[u].length-1]),str:"none",wid:1});for(var p=PolyTools.triangulate(s[u],{area:100,convex:!0,optimize:!1}),w=0;w<p.length;w++){var x=PolyTools.midPt(p[w]),m=c(x[0],x[1]);l+=poly(p[w],{fil:m,str:m,wid:1})}}return l},this.rock=function(n,e,d,o){var o=o==null?{}:o,t=o.hei==null?80:o.hei,r=o.wid==null?100:o.wid,h=o.tex==null?40:o.tex,s=o.ret==null?0:o.ret,u=o.sha==null?10:o.sha;d=d==null?0:d;for(var f="",g=[10,50],c=[],m=0;m<g[0];m++){c.push([]);for(var w=[],x=0;x<g[1];x++)w.push(Noise.noise(m,.2*x,d));loopNoise(w);for(var x=0;x<g[1];x++){var b=2*(x/g[1]*Math.PI)-Math.PI/2,a=r*t/Math.sqrt(Math.pow(t*Math.cos(b),2)+Math.pow(r*Math.sin(b),2));a*=.7+.3*w[x];var y=1-m/g[0],p=Math.cos(b)*a*y,P=-Math.sin(b)*a*y;(Math.PI<b||0>b)&&(P*=.2),P+=.2*(t*(m/g[0])),c[c.length-1].push([p,P])}}f+=poly(c[0].concat([[0,0]]),{xof:n,yof:e,fil:"white",str:"none"}),f+=stroke(c[0].map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,0.3)",noi:1,wid:3}),f+=texture(c,{xof:n,yof:e,tex:h,wid:3,sha:u,col:function(){return"rgba(180,180,180,"+(.3+.3*Math.random()).toFixed(3)+")"},dis:function(){return .5<Math.random()?.15+.15*Math.random():.85-.15*Math.random()}});for(var m=0;m<g[0];m++);return f}},Arch=new function(){var n=function(n,e){e=e==null?0:e;for(var d=0;d<n.length;d++)if(0<n[d].length)if("object"==typeof n[d][0])for(var o=0;o<n[d].length;o++)n[d][o][0]=e-(n[d][o][0]-e);else n[d][0]=e-(n[d][0]-e);return n},e=function(n,e,d){for(var d=d==null?{}:d,o=d.hei==null?40:d.hei,t=d.wid==null?180:d.wid,a=d.tex==null?300:d.tex,r=[10,10],l=[],h=0;h<r[0];h++){l.push([]);for(var s=o+.2*o*Math.random(),u=0;u<r[1];u++){var f=t*(h/(r[0]-1)-.5)*Math.pow(u/(r[1]-1),.7),g=s*(u/(r[1]-1));l[l.length-1].push([f,g])}}var c="";c+=poly(l[0].slice(0,-1).concat(l[l.length-1].slice(0,-1).reverse()),{xof:n,yof:e,fil:"white",str:"none"}),c+=poly(l[0],{xof:n,yof:e,fil:"none",str:"rgba(100,100,100,0.3)",wid:2}),c+=poly(l[l.length-1],{xof:n,yof:e,fil:"none",str:"rgba(100,100,100,0.3)",wid:2}),c+=texture(l,{xof:n,yof:e,tex:a,wid:1,len:.25,col:function(){return"rgba(120,120,120,"+(.3+.3*Math.random()).toFixed(3)+")"},dis:function(){return wtrand(n=>n*n)},noi:function(){return 5}});for(var h=0;h<r[0];h++);return c},d=function(n,e,d){var d=d==null?{}:d,o=d.hei==null?20:d.hei,t=d.wid==null?120:d.wid,a=d.rot==null?.7:d.rot,r=d.per==null?4:d.per,l=!(d.tra!=null)||d.tra,h=!(d.bot!=null)||d.bot,s=d.wei==null?3:d.wei,u=d.dec==null?function(){return[]}:d.dec,f=.5*-t+t*a,g=.5*-t+t*(1-a),c=[];c.push(div([[.5*-t,-o],[.5*-t,0]],5)),c.push(div([[.5*t,-o],[.5*t,0]],5)),h&&(c.push(div([[.5*-t,0],[f,r]],5)),c.push(div([[.5*t,0],[f,r]],5))),c.push(div([[f,-o],[f,r]],5)),l&&(h&&(c.push(div([[.5*-t,0],[g,-r]],5)),c.push(div([[.5*t,0],[g,-r]],5))),c.push(div([[g,-o],[g,-r]],5)));var m=2*(.5>a)-1;c=c.concat(u({pul:[.5*(m*t),-o],pur:[f,-o+r],pdl:[.5*(m*t),0],pdr:[f,r]}));var p="";l||(p+=poly([[.5*-t,-o],[.5*t,-o],[.5*t,0],[f,r],[.5*-t,0]],{xof:n,yof:e,str:"none",fil:"white"}));for(var w=0;w<c.length;w++)p+=stroke(c[w].map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,0.4)",noi:1,wid:s,fun:function(){return 1}});return p},o=function(n,e){var e=e==null?{}:e,d=e.pul==null?[0,0]:e.pul,o=e.pur==null?[0,100]:e.pur,t=e.pdl==null?[100,0]:e.pdl,a=e.pdr==null?[100,100]:e.pdr,r=e.hsp==null?[1,3]:e.hsp,l=e.vsp==null?[1,2]:e.vsp,h=[],s=div([d,t],l[1]),u=div([o,a],l[1]),f=div([d,o],r[1]),g=div([t,a],r[1]);if(1==n){for(var c=f[r[0]],m=f[f.length-1-r[0]],p=g[r[0]],w=g[f.length-1-r[0]],x=l[0];x<s.length-l[0];x+=l[0]){var b=div([c,p],l[1])[x],y=div([m,w],l[1])[x],P=s[x],I=u[x];h.push(div([b,P],5)),h.push(div([y,I],5))}h.push(div([c,p],5)),h.push(div([m,w],5))}else if(2==n)for(var x=r[0];x<f.length-r[0];x+=r[0]){var v=f[x],k=g[x];h.push(div([v,k],5))}else if(3==n){for(var c=f[r[0]],m=f[f.length-1-r[0]],p=g[r[0]],w=g[f.length-1-r[0]],x=l[0];x<s.length-l[0];x+=l[0]){var b=div([c,p],l[1])[x],y=div([m,w],l[1])[x],j=div([c,m],l[1])[x],F=div([p,w],l[1])[x],P=s[x],I=u[x];h.push(div([b,y],5)),h.push(div([j,F],5))}h.push(div([c,p],5)),h.push(div([m,w],5))}return h},t=function(n,e,d,o){var o=null==o?{}:o,t=null==o.hei?20:o.hei,a=null==o.wid?180:o.wid,r=null==o.rot?.7:o.rot,l=null==o.per?4:o.per,h=null==o.seg?4:o.seg,s=null==o.wei?1:o.wei,u=null==o.tra||o.tra,f=null==o.fro||o.fro;d=null==d?0:d;var g=.5*-a+a*r,c=.5*-a+a*(1-r),m=[];if(f&&(m.push(div([[.5*-a,0],[g,l]],h)),m.push(div([[g,l],[.5*a,0]],h))),u&&(m.push(div([[.5*-a,0],[c,-l]],h)),m.push(div([[c,-l],[.5*a,0]],h))),f&&(m.push(div([[.5*-a,-t],[g,-t+l]],h)),m.push(div([[g,-t+l],[.5*a,-t]],h))),u&&(m.push(div([[.5*-a,-t],[c,-t-l]],h)),m.push(div([[c,-t-l],[.5*a,-t]],h))),u){var p=Math.floor(Math.random()*m.length);m[p]=m[p].slice(0,-1),m[(p+m.length)%m.length]=m[(p+m.length)%m.length].slice(0,-1)}for(var w="",x=0;x<m.length/2;x++)for(var b=0;b<m[x].length;b++){m[x][b][1]+=(Noise.noise(x,.5*b,d)-.5)*t,m[(m.length/2+x)%m.length][b%m[(m.length/2+x)%m.length].length][1]+=(Noise.noise(x+.5,.5*b,d)-.5)*t;var y=div([m[x][b],m[(m.length/2+x)%m.length][b%m[(m.length/2+x)%m.length].length]],2);y[0][0]+=.5*((Math.random()-.5)*t),w+=poly(y,{xof:n,yof:e,fil:"none",str:"rgba(100,100,100,0.5)",wid:2})}for(var x=0;x<m.length;x++)w+=stroke(m[x].map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,0.5)",noi:.5,wid:s,fun:function(){return 1}});return w},a=function(e,d,o){var o=o==null?{}:o,t=o.hei==null?20:o.hei,r=o.wid==null?120:o.wid,l=o.rot==null?.7:o.rot,h=o.per==null?4:o.per,s=o.cor==null?5:o.cor,u=o.wei==null?3:o.wei,f=o.pla==null?[0,""]:o.pla,g=function(e){return .5>l?n(e):e},c=.5>l?1-l:l,m=.5*-r+r*c,p=.5*(m+.5*r)-m,w=[];w.push(div(g([[.5*-r+p,-t-h/2],[.5*-r+.5*p,-t/2-h/4],[.5*-r-s,0]]),5)),w.push(div(g([[m+p,-t],[(m+p+.5*r)/2,-t/2],[.5*r+s,0]]),5)),w.push(div(g([[m+p,-t],[m+p/2,-t/2+h/2],[m+s,h]]),5)),w.push(div(g([[.5*-r-s,0],[m+s,h]]),5)),w.push(div(g([[.5*r+s,0],[m+s,h]]),5)),w.push(div(g([[.5*-r+p,-t-h/2],[m+p,-t]]),5));var x="",b=g([[.5*-r,0],[.5*-r+p,-t-h/2],[m+p,-t],[.5*r,0],[m,h]]);x+=poly(b,{xof:e,yof:d,str:"none",fil:"white"});for(var y=0;y<w.length;y++)x+=stroke(w[y].map(function(n){return[n[0]+e,n[1]+d]}),{col:"rgba(100,100,100,0.4)",noi:1,wid:u,fun:function(){return 1}});if(1==f[0]){var P=g([[m+p/2,-t/2+h/2],[.5*-r+.5*p,-t/2-h/4]]);P[0][0]>P[1][0]&&(P=[P[1],P[0]]);var I=PolyTools.midPt(P),v=Math.atan2(P[1][1]-P[0][1],P[1][0]-P[0][0]),a=180*v/Math.PI;x+="<text font-size='"+.6*t+"' font-family='Verdana' style='fill:rgba(100,100,100,0.9)' text-anchor='middle' transform='translate("+(I[0]+e)+","+(I[1]+d)+") rotate("+a+")'>"+f[1]+"</text>"}return x},r=function(n,e,d){for(var d=d==null?{}:d,o=d.hei==null?20:d.hei,t=d.wid==null?120:d.wid,a=d.rot==null?.7:d.rot,r=d.per==null?4:d.per,l=d.cor==null?10:d.cor,h=d.sid==null?4:d.sid,s=d.wei==null?3:d.wei,u=[],f=[[0,-o]],g="",c=0;c<h;c++){var m=t*(1*c/(h-1)-.5),p=r*(1-2*Math.abs(1*c/(h-1)-.5)),w=(t+l)*(1*c/(h-1)-.5);0<c&&u.push([u[u.length-1][2],[w,p]]),u.push([[0,-o],[.5*m,.5*(-o+p)],[w,p]]),f.push([w,p])}g+=poly(f,{xof:n,yof:e,str:"none",fil:"white"});for(var c=0;c<u.length;c++)g+=stroke(div(u[c],5).map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,0.4)",noi:1,wid:s,fun:function(){return 1}});return g};this.arch01=function(n,i,o,a){var a=null==a?{}:a,r=null==a.hei?70:a.hei,l=null==a.wid?180:a.wid,h=null==a.rot?.7:a.rot,s=null==a.per?5:a.per;o=null==o?0:o;var u=.4+.2*Math.random(),f="";f+=e(n,i-r,{hei:r*u,wid:l}),f+=d(n,i,{hei:r*(1-u),wid:2*l/3,per:s,bot:!1}),f+=t(n,i,o,{tra:!0,fro:!1,hei:10,wid:l,per:2*s,seg:0|3+3*Math.random()});var g=randChoice([0,1,1,2]);return 1==g?f+=Man.man(n+normRand(-l/3,l/3),i,{fli:randChoice([!0,!1]),sca:.42}):2==g&&(f+=Man.man(n+normRand(-l/4,-l/5),i,{fli:!1,sca:.42}),f+=Man.man(n+normRand(l/5,l/4),i,{fli:!0,sca:.42})),f+=t(n,i,o,{tra:!1,fro:!0,hei:10,wid:l,per:2*s,seg:0|3+3*Math.random()}),f},this.arch02=function(n,e,r,l){var l=l==null?{}:l,h=l.hei==null?10:l.hei,s=l.wid==null?50:l.wid,u=l.rot==null?.3:l.rot,f=l.per==null?5:l.per,g=l.sto==null?3:l.sto,c=l.sty==null?1:l.sty,m=l.rai!=null&&l.rai;r=r==null?0:r;for(var p="",w=0,x=0;x<g;x++){p+=d(n,e-w,{tra:!1,hei:h,wid:s*Math.pow(.85,x),rot:u,wei:1.5,per:f,dec:function(n){return o(c,Object.assign({},n,{hsp:[[],[1,5],[1,5],[1,4]][c],vsp:[[],[1,2],[1,2],[1,3]][c]}))}}),p+=m?t(n,e-w,.2*x,{wid:1.1*(s*Math.pow(.85,x)),hei:h/2,per:f,rot:u,wei:.5,tra:!1}):[];var b=void 0;1==g&&Math.random()<1/3&&(b=[1,"Pizza Hut"]),p+=a(n,e-w-h,{hei:h,wid:s*Math.pow(.9,x),rot:u,wei:1.5,per:f,pla:b}),w+=1.5*h}return p},this.arch03=function(n,e,a,l){var l=l==null?{}:l,h=l.hei==null?10:l.hei,s=l.wid==null?50:l.wid,u=l.rot==null?.7:l.rot,f=l.per==null?5:l.per,g=l.sto==null?7:l.sto;a=a==null?0:a;for(var c="",m=0,p=0;p<g;p++)c+=d(n,e-m,{tra:!1,hei:h,wid:s*Math.pow(.85,p),rot:u,wei:1.5,per:f/2,dec:function(n){return o(1,Object.assign({},n,{hsp:[1,4],vsp:[1,2]}))}}),c+=t(n,e-m,.2*p,{seg:5,wid:1.1*(s*Math.pow(.85,p)),hei:h/2,per:f/2,rot:u,wei:.5,tra:!1}),c+=r(n,e-m-h,{hei:1.5*h,wid:s*Math.pow(.9,p),rot:u,wei:1.5,per:f}),m+=1.5*h;return c},this.arch04=function(n,e,o,a){var a=a==null?{}:a,l=a.hei==null?15:a.hei,h=a.wid==null?30:a.wid,s=a.rot==null?.7:a.rot,u=a.per==null?5:a.per,f=a.sto==null?2:a.sto;o=o==null?0:o;for(var g="",c=0,m=0;m<f;m++)g+=d(n,e-c,{tra:!0,hei:l,wid:h*Math.pow(.85,m),rot:s,wei:1.5,per:u/2,dec:function(){return[]}}),g+=t(n,e-c,.2*m,{seg:3,wid:1.2*(h*Math.pow(.85,m)),hei:l/3,per:u/2,rot:s,wei:.5,tra:!0}),g+=r(n,e-c-l,{hei:1*l,wid:h*Math.pow(.9,m),rot:s,wei:1.5,per:u}),c+=1.2*l;return g},this.boat01=function(n,e,d,o){var o=null==o?{}:o,t=null==o.len?120:o.len,a=null==o.sca?1:o.sca,r=null!=o.fli&&o.fli,l="",h=r?-1:1;l+=Man.man(n+20*a*h,e,{ite:Man.stick01,hat:Man.hat02,sca:.5*a,fli:!r,len:[0,30,20,30,10,30,30,30,30]});for(var s=[],u=[],f=function(n){return 7*Math.pow(Math.sin(n*Math.PI),.5)*a},g=function(n){return 10*Math.pow(Math.sin(n*Math.PI),.5)*a},c=0;c<t*a;c+=5*a)s.push([c*h,f(c/t)]),u.push([c*h,g(c/t)]);var m=s.concat(u.reverse());return l+=poly(m,{xof:n,yof:e,fil:"white"}),l+=stroke(m.map(i=>[n+i[0],e+i[1]]),{wid:1,fun:function(n){return Math.sin(2*(n*Math.PI))},col:"rgba(100,100,100,0.4)"}),l},this.transmissionTower01=function(n,e,d,o){for(var o=null==o?{}:o,t=null==o.hei?100:o.hei,a=null==o.wid?20:o.wid,r="",l=function(i){return[i[0]+n,i[1]+e]},h=function(n){return stroke(div(n,5).map(l),{wid:1,fun:()=>.5,col:"rgba(100,100,100,0.4)"})},s=[.05*-a,-t],u=[.05*a,-t],f=[.1*-a,.9*-t],g=[.1*a,.9*-t],c=[.2*-a,.5*-t],m=[.2*a,.5*-t],p=[.5*-a,0],w=[.5*a,0],x=[[.7,-.85],[1,-.675],[.7,-.5]],b=0;b<x.length;b++)r+=h([[-x[b][0]*a,x[b][1]*t],[x[b][0]*a,x[b][1]*t]]),r+=h([[-x[b][0]*a,x[b][1]*t],[0,(x[b][1]-.05)*t]]),r+=h([[x[b][0]*a,x[b][1]*t],[0,(x[b][1]-.05)*t]]),r+=h([[-x[b][0]*a,x[b][1]*t],[-x[b][0]*a,(x[b][1]+.1)*t]]),r+=h([[x[b][0]*a,x[b][1]*t],[x[b][0]*a,(x[b][1]+.1)*t]]);for(var y=div([s,f,c,p],5),P=div([u,g,m,w],5),b=0;b<y.length-1;b++)r+=h([y[b],P[b+1]]),r+=h([P[b],y[b+1]]);return r+=h([s,u]),r+=h([f,g]),r+=h([c,m]),r+=h([s,f,c,p]),r+=h([u,g,m,w]),r}},Man=new function(){var n=function(n,e){vtxlist0=[],vtxlist1=[],vtxlist=[];for(var d=10*Math.random(),o=1;o<n.length-1;o++){var t=e(o/n.length),r=Math.atan2(n[o][1]-n[o-1][1],n[o][0]-n[o-1][0]),h=Math.atan2(n[o][1]-n[o+1][1],n[o][0]-n[o+1][0]),s=(r+h)/2;s<h&&(s+=Math.PI),vtxlist0.push([n[o][0]+t*Math.cos(s),n[o][1]+t*Math.sin(s)]),vtxlist1.push([n[o][0]-t*Math.cos(s),n[o][1]-t*Math.sin(s)])}var u=n.length-1,l=Math.atan2(n[1][1]-n[0][1],n[1][0]-n[0][0])-Math.PI/2,r=Math.atan2(n[u][1]-n[u-1][1],n[u][0]-n[u-1][0])-Math.PI/2,f=e(0),g=e(1);return vtxlist0.unshift([n[0][0]+f*Math.cos(l),n[0][1]+f*Math.sin(l)]),vtxlist1.unshift([n[0][0]-f*Math.cos(l),n[0][1]-f*Math.sin(l)]),vtxlist0.push([n[u][0]+g*Math.cos(r),n[u][1]+g*Math.sin(r)]),vtxlist1.push([n[u][0]-g*Math.cos(r),n[u][1]-g*Math.sin(r)]),[vtxlist0,vtxlist1]},e=function(n,e,i){var d=i.map(function(n){return[-n[0],n[1]]}),o=Math.atan2(e[1]-n[1],e[0]-n[0])-Math.PI/2,t=distance(n,e),a=d.map(function(e){var i=distance(e,[0,0]),d=Math.atan2(e[1],e[0]);return[n[0]+i*t*Math.cos(o+d),n[1]+i*t*Math.sin(o+d)]});return a},d=function(n){return n.map(function(n){return[-n[0],n[1]]})};this.hat01=function(n,o,t){var t=null==t?{}:t,a=null!=t.fli&&t.fli,r="",l=Math.random(),h=a?d:function(n){return n};r+=poly(e(n,o,h([[-.3,.5],[.3,.8],[.2,1],[0,1.1],[-.3,1.15],[-.55,1],[-.65,.5]])),{fil:"rgba(100,100,100,0.8)"});for(var s=[],u=0;10>u;u++)s.push([-.3-.1*(Noise.noise(.2*u,l)*u),.5-.3*u]);return r+=poly(e(n,o,h(s)),{str:"rgba(100,100,100,0.8)",wid:1}),r},this.hat02=function(n,i,o){var o=null==o?{}:o,t=null!=o.fli&&o.fli,a="",r=Math.random(),l=t?d:function(n){return n};return a+=poly(e(n,i,l([[-.3,.5],[-1.1,.5],[-1.2,.6],[-1.1,.7],[-.3,.8],[.3,.8],[1,.7],[1.3,.6],[1.2,.5],[.3,.5]])),{fil:"rgba(100,100,100,0.8)"}),a},this.stick01=function(n,o,t){for(var t=null==t?{}:t,a=null!=t.fli&&t.fli,r="",h=Math.random(),s=a?d:function(n){return n},u=[],f=12,l=0;l<f;l++)u.push([5*(.1*-Noise.noise(.1*l,h)*Math.sin(l/f*Math.PI)),0+.3*l]);return r+=poly(e(n,o,s(u)),{str:"rgba(100,100,100,0.5)",wid:1}),r},this.man=function(e,d,o){function t(n,e){for(var d=Object.keys(n),o=0;o<d.length;o++){if(d[o]==e)return[e];var a=t(n[d[o]],e);if(!1!=a)return[parseFloat(d[o])].concat(a)}return!1}function r(n,e){for(var d=t(n,e),o=0,a=0;a<d.length;a++)o+=c[d[a]];return o}function l(n,e){for(var d,o=t(n,e),l=[0,0],h=0;h<o.length;h++)d=r(n,o[h]),l[0]+=m[o[h]]*Math.cos(d),l[1]+=m[o[h]]*Math.sin(d);return l}var o=null==o?{}:o,h=null==o.sca?.5:o.sca,u=null==o.hat?Man.hat01:o.hat,f=null==o.ite?function(){return""}:o.ite,g=null==o.fli||o.fli,c=null==o.ang?[0,-Math.PI/2,normRand(0,0),Math.PI/4*Math.random(),3*Math.PI/4*Math.random(),3*Math.PI/4,-Math.PI/4,3*-Math.PI/4-Math.PI/4*Math.random(),-Math.PI/4]:o.ang,m=null==o.len?[0,30,20,30,30,30,30,30,30]:o.len;m=m.map(function(n){return n*h});for(var p="",w={0:{1:{2:{},5:{6:{}},7:{8:{}}},3:{4:{}}}},x=function(n){return[(g?-1:1)*n[0]+e,n[1]+d]},b=[],y=0;y<c.length;y++)b.push(l(w,y));d-=b[4][1];for(var y=1;y<b.length;y++)var a=t(w,y),P=l(w,a[a.length-2]),I=div([P,b[y]],10);var s=function(e,i){var d="",o=bezmh(e,2),[t,a]=n(o,i);return d+=poly(t.concat(a.reverse()).map(x),{fil:"white"}),d+=stroke(t.map(x),{wid:1,col:"rgba(100,100,100,0.5)"}),d+=stroke(a.map(x),{wid:1,col:"rgba(100,100,100,0.6)"}),d},v=function(n){return 8*h*(Math.sin(.5*n*Math.PI)*Math.pow(Math.sin(n*Math.PI),.1)+.4*(1-n))},k=function(n){return 7*h*Math.pow(.25-Math.pow(n-.5,2),.3)};p+=f(x(b[8]),x(b[6]),{fli:g}),p+=s([b[1],b[7],b[8]],v),p+=s([b[1],b[0],b[3],b[4]],function(n){return 11*h*(Math.sin(.5*n*Math.PI)*Math.pow(Math.sin(n*Math.PI),.1)+.5*(1-n))}),p+=s([b[1],b[5],b[6]],v),p+=s([b[1],b[2]],k);var j=bezmh([b[1],b[2]],2),[F,q]=n(j,k);return F.splice(0,Math.floor(.1*F.length)),q.splice(0,Math.floor(.95*q.length)),p+=poly(F.concat(q.reverse()).map(x),{fil:"rgba(100,100,100,0.6)"}),p+=u(x(b[1]),x(b[2]),{fli:g}),p}};function water(n,e,d,o){for(var o=o==null?{}:o,t=o.hei==null?2:o.hei,a=o.len==null?800:o.len,r=o.clu==null?10:o.clu,l="",h=[],s=0,u=0;u<r;u++){h.push([]);var f=(Math.random()-.5)*(a/8);s+=5*Math.random();for(var g=a/4+Math.random()*(a/4),c=-g;c<g;c+=5)h[h.length-1].push([c+f,Math.sin(.2*c)*t*Noise.noise(.1*c)-20+s])}for(var c=1;c<h.length;c+=1)l+=stroke(h[c].map(function(i){return[i[0]+n,i[1]+e]}),{col:"rgba(100,100,100,"+(.3+.3*Math.random()).toFixed(3)+")",wid:1});return l}function mountplanner(n,e){function d(n,e,d,o){var t=d(n,e);if(.3>=t)return!1;for(var a=n-o;a<n+o;a++)for(var r=e-o;r<e+o;r++)if(d(a,r)>t)return!1;return!0}function o(n,e){e=null==e?10:e;for(var i=0;i<a.length;i++)if(Math.abs(a[i].x-n.x)<e)return!1;return a.push(n),!0}for(var t,a=[],l=.03,h=function(n){return 2*Math.max(Noise.noise(n*l)-.55,0)},s=function(n){return Noise.noise(.01*n,Math.PI)},u=5,f=200,g=n;g<e;g+=u)t=Math.floor(g/u),MEM.planmtx[t]=MEM.planmtx[t]||0;for(var g=n;g<e;g+=u){for(var c=0;c<480*s(g);c+=30)if(d(g,c,h,2)){var m=g+500*(2*(Math.random()-.5)),p=c+300,w={tag:"mount",x:m,y:p,h:h(g,c)},x=o(w);if(x)for(var b=Math.floor((m-f)/u);b<(m+f)/u;b++)MEM.planmtx[b]+=1}if(Math.abs(g)%1e3<Math.max(1,u-1)){var w={tag:"distmount",x:g,y:280-50*Math.random(),h:h(g,c)};o(w)}}for(var g=n;g<e;g+=u)if(!(0==MEM.planmtx[Math.floor(g/u)]));else if(.01>Math.random())for(var w,c=0;c<4*Math.random();c++)w={tag:"flatmount",x:g+700*(2*(Math.random()-.5)),y:700-50*c,h:h(g,c)},o(w);for(var g=n;g<e;g+=u)if(.2>Math.random()){var w={tag:"boat",x:g,y:300+390*Math.random()};o(w,400)}return a}MEM={canv:"",chunks:[],xmin:0,xmax:0,cwid:512,cursx:0,lasttick:0,windx:3e3,windy:800,planmtx:[]};function chunkloader(n,e){for(var d=function(n){if(n.canv.includes("NaN")&&(n.canv=n.canv.replace(/NaN/g,-1e3)),0==MEM.chunks.length)return void MEM.chunks.push(n);if(n.y<=MEM.chunks[0].y)return void MEM.chunks.unshift(n);if(n.y>=MEM.chunks[MEM.chunks.length-1].y)return void MEM.chunks.push(n);for(var e=0;e<MEM.chunks.length-1;e++)if(MEM.chunks[e].y<=n.y&&n.y<=MEM.chunks[e+1].y)return void MEM.chunks.splice(e+1,0,n)};e>MEM.xmax-MEM.cwid||n<MEM.xmin+MEM.cwid;){var o;e>MEM.xmax-MEM.cwid?(o=mountplanner(MEM.xmax,MEM.xmax+MEM.cwid),MEM.xmax+=MEM.cwid):(o=mountplanner(MEM.xmin-MEM.cwid,MEM.xmin),MEM.xmin-=MEM.cwid);for(var t=0;t<o.length;t++)"mount"==o[t].tag?(d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:Mount.mountain(o[t].x,o[t].y,2*t*Math.random())}),d({tag:o[t].tag,x:o[t].x,y:o[t].y-1e4,canv:water(o[t].x,o[t].y,2*t)})):"flatmount"==o[t].tag?d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:Mount.flatMount(o[t].x,o[t].y,2*Math.random()*Math.PI,{wid:600+400*Math.random(),hei:100,cho:.5+.2*Math.random()})}):"distmount"==o[t].tag?d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:Mount.distMount(o[t].x,o[t].y,100*Math.random(),{hei:150,len:randChoice([500,1e3,1500])})}):"boat"==o[t].tag?d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:Arch.boat01(o[t].x,o[t].y,Math.random(),{sca:o[t].y/800,fli:randChoice([!0,!1])})}):"redcirc"==o[t].tag?d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:"<circle cx='"+o[t].x+"' cy='"+o[t].y+"' r='20' stroke='black' fill='red' />"}):"greencirc"==o[t].tag&&d({tag:o[t].tag,x:o[t].x,y:o[t].y,canv:"<circle cx='"+o[t].x+"' cy='"+o[t].y+"' r='20' stroke='black' fill='green' />"})}}function chunkrender(n,e){MEM.canv="";for(var d=0;d<MEM.chunks.length;d++)n-MEM.cwid<MEM.chunks[d].x&&MEM.chunks[d].x<e+MEM.cwid&&(MEM.canv+=MEM.chunks[d].canv)}function calcViewBox(){var n=1.142;return""+MEM.cursx+" 0 "+MEM.windx/n+" "+MEM.windy/n}function update(){self.chunkloader(MEM.cursx,MEM.cursx+MEM.windx),self.chunkrender(MEM.cursx,MEM.cursx+MEM.windx),document.getElementById("BG").innerHTML="<svg id='SVG' xmlns='http://www.w3.org/2000/svg' width='"+MEM.windx+"' height='"+MEM.windy+"' style='mix-blend-mode:multiply;'viewBox = '"+calcViewBox()+"'><g id='G' transform='translate("+0+",0)'>"+MEM.canv+"</g></svg>"}var lastScrollX=0,pFrame=0;function present(){var n=window.scrollX,e=1;document.body.scrollTo(Math.max(0,pFrame-10),window.scrollY),pFrame+=e,(20>pFrame||Math.abs(lastScrollX-n)<2*e)&&(lastScrollX=n,setTimeout(present,1))}MEM.lasttick=new Date().getTime(),MEM.windx=window.innerWidth,document.getElementById("BG").setAttribute("style","width:"+MEM.windx+"px"),update(),document.body.scrollTo(0,0),present();
